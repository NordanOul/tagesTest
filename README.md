# Тестовое задание
Логика:
Данные с веб-формы попадают в микросервис. Микросервис генерирует дату и время подачи заявки и отправляет входные данные с веб-формы + сгенерирвоанные данные в СРМ. СРМ автоматически фильтрует данные по заявкам и отдает их обратно в микросервис, т.к. веб-форма по нажатию кнопки "отправить" должна вернуть пользователю сообщение по итогам формирования результата СРМ. Микросервис берет ответ от СРМ и отправляет на веб-форму сообщение + на адрес электронной почты письмо с данными о мероприятии.
Заявка считается зарегестрированной:
1. если в СРМ нет заявки с уже существующим адресом электронной почты;
2. если, количество участников не превышает лимита по мероприятию;
3. если, заявка получила Статус "Одобрено" в СРМ.

Входные данные

| Атрибут                   | Тип данных | Обязательный? | Описание                                                                                 |
| :------------------------ |:---------- | :------------ |:---------------------------------------------------------------------------------------- |
| Адрес электронной почты   | Строка     | Да            | Адрес электронной почты для подтверждения регистрации и отправки пригласительных билетов |
| Контактный номер телефона | Число      | Нет           | Телефон для связи с зарегистрированным посетителем                                       |
| Имя                       | Строка     | Да            | Имя                                                                                      |
| Фамилия                   | Строка     | Да            | Фамилия                                                                                  |
| Компания                  | Строка     | Нет           | Компания                                                                                 |
| Роль в проектах           | Строка     | Нет           | Роль в проектах                                                                          |


| Атрибут                     | Тип данных | Обязательный? | Описание                                                                                 |
| :-------------------------- |:---------- | :------------ |:---------------------------------------------------------------------------------------- |
| Наименование мероприятия    | Строка     | Да            | Адрес электронной почты для подтверждения регистрации и отправки пригласительных билетов |
| Дату проведения мероприятия | Число      | Нет           | Телефон для связи с зарегистрированным посетителем                                       |
| Дату и время регистрации    | Строка     | Да            | Имя                                                                                      |

Выходные данные

| Атрибут                                                        | Тип данных | Обязательный? | Описание         |
| :------------------------------------------------------------- |:---------- | :------------ |:---------------- |
| Сообщение, если регистрация успешна                            | Строка     | Да            | “Вы успешно зарегистрированы на мероприятие, подробная информация направлена вам на электронную почту” |
|Сообщение, если данные уже присутствуют в CRM                   | Строка     | Да            | “Вы успешно зарегистрированы на мероприятие, подробная информация направлена вам на электронную почту" |
| Сообщение, , если превышен лимит по зарегистрированным заявкам | Строка     | Да            | “К сожалению, кол-во свободных мест закончилось, мы не можем вас зарегистрировать на мероприятие”  |

title Микросервис
bottomparticipants
actor Пользователь
participant Web-форма
participant Микросервис
participant CRM
activate Web-форма
Пользователь->Web-форма:Регистрация на мероприятие\n#TagesMeet, ввод данных
activate Микросервис
note over Web-форма:Формирование **наименования**\nи **даты проведения** мероприятия
Web-форма->Микросервис:Отправка входных данных\nв микросервис
activate CRM
note over Микросервис: Формирование **даты и времени**\nрегистрации
Микросервис->CRM: Отправка данных в CRM

note over CRM: Проверка по уже имеющимся данным в CRM,\n выдача статуса заявки

alt Если данные уже присутствуют в системе CRM
Микросервис<--CRM:Ответ от СРМ
note over Микросервис: Формирование сообщения по результатам ответа CRM
Web-форма<--Микросервис: Ответ от микросервиса
note over Web-форма: “Вы уже были зарегистрированы на мероприятие.\nВся информация направлена вам на адрес электронной почты.\nЕсли письмо не дошло, проверьте папку “спам” на сервере или свяжитесь с организаторами”

else Если превышен лимит по зарегистрированным заявкам
Микросервис<--CRM:Ответ от СРМ
note over Микросервис: Формирование сообщения по результатам ответа CRM
Web-форма<--Микросервис: Ответ от микросервиса
note over Web-форма: “К сожалению,\nкол-во свободных мест закончилось,\nмы не можем вас зарегистрировать на мероприятие”

else Успешная регистрация
Микросервис<--CRM:Ответ от СРМ
note over Микросервис: Формирование сообщения по результатам ответа CRM
Web-форма<--Микросервис: Ответ от микросервиса
note over Web-форма:“Вы успешно зарегистрированы на мероприятие,\nподробная информация направлена вам\nна электронную почту”
Микросервис->CRM: Запрос на выдачу пользователю/n данных по мероприятию
Пользователь<--CRM: Отправка письма с подробной информацией по мероприятию

end





